<div class='page'>
  <mat-tab-group>
    <!-----------------------------------Sales By Color------------------------------------------->
    <mat-tab label="Sales By Color">
      <br />
      <div fxLayout="row" fxLayoutAlign="start center">
        <mat-form-field appearance="outline">
          <mat-label>Date Range</mat-label>
          <mat-select [(value)]="searchRequest.dateRange">
            <mat-option *ngFor="let drange of dateRange" [value]="drange">{{drange}}</mat-option>
          </mat-select>
        </mat-form-field>
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="SalebyColor()">Load</button>
        </div>
        <div style="width: 50px; margin: 15px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="SalebyColorReset()">Clear</button>
        </div>
      </div>
      <div *ngIf="colortableisShown">
        <div class="title-with-boarder2" style="margin-top:2.5%">
          Results:
        </div>
        <br />
        <div class="example-container mat-elevation-z8">
          <table mat-table [dataSource]="reportSalesbyColor" class="mat-elevation-z8">

            <!--- Note that these columns can be defined in any order.
          The actual rendered columns are set as a property on the row definition" -->
            <!-- Position Column -->
            <ng-container matColumnDef="VehicleColor">
              <th mat-header-cell *matHeaderCellDef> Vehicle Color </th>
              <td mat-cell *matCellDef="let element"> {{element.VehicleColor}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="NumberOfCarsSold">
              <th mat-header-cell *matHeaderCellDef> Number Of Cars Sold </th>
              <td mat-cell *matCellDef="let element"> {{element.NumberOfCarsSold}} </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Sales By Vehicle Type"> <app-salebytype model = 'Type'></app-salebytype></mat-tab>
    <!-----------------------------------Sales by Manufacturer------------------------------------------->
    <mat-tab label="Sales By Manufacturer">
      <br />
      <div fxLayout="row" fxLayoutAlign="start center">
        <mat-form-field appearance="outline">
          <mat-label>Date Range</mat-label>
          <mat-select [(value)]="searchRequest.dateRange">
            <mat-option *ngFor="let drange of dateRange" [value]="drange">{{drange}}</mat-option>
          </mat-select>
        </mat-form-field>
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="SalebyManufacturer()">Load</button>
        </div>
        <div style="width: 50px; margin: 15px; ">
          <button mat-raised-button color="primary" class="search-button" (click)=" SalebyManufacturerReset()">Clear</button>
        </div>
      </div>
      <div *ngIf="manufacturertableisShown">
        <div class="title-with-boarder2" style="margin-top:2.5%">
          Results:
        </div>
        <br />
        <div class="example-container mat-elevation-z8">
          <table mat-table [dataSource]="reportSalesbyManufacturer" class="mat-elevation-z8">

            <!--- Note that these columns can be defined in any order.
          The actual rendered columns are set as a property on the row definition" -->
            <!-- Position Column -->
            <ng-container matColumnDef="VehicleManufacturer">
              <th mat-header-cell *matHeaderCellDef> Vehicle Manufacturer </th>
              <td mat-cell *matCellDef="let element"> {{element.VehicleManufacturer}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="NumberOfCarsSold">
              <th mat-header-cell *matHeaderCellDef> Number Of Cars Sold </th>
              <td mat-cell *matCellDef="let element"> {{element.NumberOfCarsSold}} </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumnsmanufacturer; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsmanufacturer;"></tr>
          </table>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Monthly Sales"><app-sale-monthly></app-sale-monthly></mat-tab>
    

    <mat-tab label="Below Cost Sales">

      <div fxLayout="row" fxLayoutAlign="start center">
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="BelowCostSales()">Load</button>
        </div>
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="BelowCostSalesReset()">Clear</button>
        </div>
      </div>
      <div *ngIf="belowcosttableisShown">
        <div class="title-with-boarder2" style="margin-top:2.5%">
          Results:
        </div>
        <br />
        <div class="example-container mat-elevation-z8">
          <table mat-table [dataSource]="reportBelowCostSales" class="mat-elevation-z8">
            <!-- SoldDate Column -->
            <ng-container matColumnDef="SoldDate">
              <th mat-header-cell *matHeaderCellDef> Sold Date </th>
              <td mat-cell *matCellDef="let element1"> {{element1.SoldDate | date:'YYYY-MM-dd '}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="InvoicePrice">
              <th mat-header-cell *matHeaderCellDef> Invoice Price </th>
              <td mat-cell *matCellDef="let element1"> {{element1.InvoicePrice}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="SoldPrice">
              <th mat-header-cell *matHeaderCellDef> Sold Price </th>
              <td mat-cell *matCellDef="let element1"> {{element1.SoldPrice}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="SoldInvoicePercentage">
              <th mat-header-cell *matHeaderCellDef> Sold/Invoice Percentage </th>
              <td mat-cell *matCellDef="let element1"> {{element1.SoldInvoicePercentage}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="CustomerName">
              <th mat-header-cell *matHeaderCellDef> Customer Name </th>
              <td mat-cell *matCellDef="let element1"> {{element1.CustomerName}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="SalespersonName">
              <th mat-header-cell *matHeaderCellDef> Salesperson Name </th>
              <td mat-cell *matCellDef="let element1"> {{element1.SalespersonName}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsbelowcostsales; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsbelowcostsales;let element1" [ngClass]="{'highlight': element1.SoldInvoicePercentage <= 95.0 }"></tr>
          </table>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Gross Customer Income"><app-customer-income></app-customer-income></mat-tab>

    <!-----------------------------------Repairs by Manufacturer/Type/Model------------------------------------------->
    <mat-tab label="Repairs by Manufacturer/Type/Model">
      <div fxLayout="row" fxLayoutAlign="start center">
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="ConstructRepairTree()">Load</button>
        </div>
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button  color="primary" class="search-button" (click)="RepairReportReset()">Clear</button>
        </div>
      </div>
      <div *ngIf="repairtableisShown">

        <table mat-table [dataSource]="reportrepair" multiTemplateDataRows class="mat-elevation-z8">

          <ng-container matColumnDef="ManufacturerName">
            <th mat-header-cell *matHeaderCellDef>Manufacturer Name</th>
            <td mat-cell *matCellDef="let element1"> {{element1.ManufacturerName}} </td>
          </ng-container>
          <ng-container matColumnDef="CountofRepairds">
            <th mat-header-cell *matHeaderCellDef>Count of Repairs</th>
            <td mat-cell *matCellDef="let element1"> {{element1.CountofRepairds}} </td>
          </ng-container>
          <ng-container matColumnDef="TotalPartsCharge">
            <th mat-header-cell *matHeaderCellDef>Total Parts Charge</th>
            <td mat-cell *matCellDef="let element1"> {{element1.TotalPartsCharge}} </td>
          </ng-container>
          <ng-container matColumnDef="TotalLaborCharge">
            <th mat-header-cell *matHeaderCellDef>Total Labor Charge</th>
            <td mat-cell *matCellDef="let element1"> {{element1.TotalLaborCharge}} </td>
          </ng-container>
          <ng-container matColumnDef="TotalRepairCosts">
            <th mat-header-cell *matHeaderCellDef>Total Repair Costs</th>
            <td mat-cell *matCellDef="let element1"> {{element1.TotalRepairCosts}} </td>
          </ng-container>

          <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->

          <ng-container matColumnDef="expandedDetail1">
            <td mat-cell *matCellDef="let element1" [attr.colspan]="displayedColumnRepair1.length">
              <div class="example-element-detail" [@detailExpand]="element1 == expandedElement1 ? 'expanded' : 'collapsed'">

                <table mat-table [dataSource]="element1.children" class="mat-elevation-z8" multiTemplateDataRows>
                  <ng-container matColumnDef="VehicleType">
                    <th mat-header-cell *matHeaderCellDef>Vehicle Type</th>
                    <td mat-cell *matCellDef="let element2"> {{element2.VehicleType}} </td>
                  </ng-container>
                  <ng-container matColumnDef="CountofRepairs">
                    <th mat-header-cell *matHeaderCellDef>Count of Repairs</th>
                    <td mat-cell *matCellDef="let element2"> {{element2.CountofRepairs}} </td>
                  </ng-container>
                  <ng-container matColumnDef="TotalPartsCharge">
                    <th mat-header-cell *matHeaderCellDef>Total Parts Charge</th>
                    <td mat-cell *matCellDef="let element2"> {{element2.TotalPartsCharge}} </td>
                  </ng-container>
                  <ng-container matColumnDef="TotalLaborCharge">
                    <th mat-header-cell *matHeaderCellDef>Total Labor Charge</th>
                    <td mat-cell *matCellDef="let element2"> {{element2.TotalLaborCharge}} </td>
                  </ng-container>
                  <ng-container matColumnDef="TotalRepairCosts">
                    <th mat-header-cell *matHeaderCellDef>Total Repair Costs</th>
                    <td mat-cell *matCellDef="let element2"> {{element2.TotalRepairCosts}} </td>
                  </ng-container>

                  <ng-container matColumnDef="expandedDetail2">
                    <td mat-cell *matCellDef="let element2" [attr.colspan]="displayedColumnRepair2.length">
                      <div class="example-element-detail" [@detailExpand]="element2 == expandedElement2 ? 'expanded' : 'collapsed'">

                        <table mat-table [dataSource]="element2.children" class="mat-elevation-z8">
                          <ng-container matColumnDef="VehicleModel">
                            <th mat-header-cell *matHeaderCellDef>Vehicle Model</th>
                            <td mat-cell *matCellDef="let element3"> {{element3.VehicleModel}} </td>
                          </ng-container>
                          <ng-container matColumnDef="CountofRepairds">
                            <th mat-header-cell *matHeaderCellDef>Count of Repairs</th>
                            <td mat-cell *matCellDef="let element3"> {{element3.CountofRepairds}} </td>
                          </ng-container>
                          <ng-container matColumnDef="TotalPartsCharge">
                            <th mat-header-cell *matHeaderCellDef>Total Parts Charge</th>
                            <td mat-cell *matCellDef="let element3"> {{element3.TotalPartsCharge}} </td>
                          </ng-container>
                          <ng-container matColumnDef="TotalLaborCharge">
                            <th mat-header-cell *matHeaderCellDef>Total Labor Charge</th>
                            <td mat-cell *matCellDef="let element3"> {{element3.TotalLaborCharge}} </td>
                          </ng-container>
                          <ng-container matColumnDef="TotalRepairCosts">
                            <th mat-header-cell *matHeaderCellDef>Total Repair Costs</th>
                            <td mat-cell *matCellDef="let element3"> {{element3.TotalRepairCosts}} </td>
                          </ng-container>
                          <tr mat-header-row *matHeaderRowDef="displayedColumnRepair3"></tr>
                          <tr mat-row *matRowDef="let row; columns: displayedColumnRepair3;"></tr>
                        </table>

                      </div>
                    </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumnRepair2"></tr>
                  <tr mat-row *matRowDef="let element2; columns: displayedColumnRepair2;" class="example-element-row" [class.example-expanded-row]="expandedElement2 === element2" (click)="expandedElement2 = expandedElement2 === element2 ? null : element2">
                  </tr>

                  <tr mat-row *matRowDef="let row; columns: ['expandedDetail2']" class="example-detail-row"></tr>


                  <!--<tr mat-header-row *matHeaderRowDef="displayedColumnRepair2"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumnRepair2;"></tr>-->
                </table>

              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumnRepair1"></tr>
          <tr mat-row *matRowDef="let element1; columns: displayedColumnRepair1;" class="example-element-row" [class.example-expanded-row]="expandedElement1 === element1" (click)="expandedElement1 = expandedElement1 === element1 ? null : element1">
          </tr>

          <tr mat-row *matRowDef="let row; columns: ['expandedDetail1']" class="example-detail-row"></tr>
        </table>


      </div>
    </mat-tab>

    <!-----------------------------------Average Time in Inventory------------------------------------------->
    <mat-tab label="Average Time in Inventory">
      <div fxLayout="row" fxLayoutAlign="start center">
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="AveTimeinInventory()">Load</button>
        </div>
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="AveTimeinInventoryReset()">Clear</button>
        </div>
      </div>
      <div *ngIf="timeininventorytableisShown">
        <div class="title-with-boarder2" style="margin-top:2.5%">
          Results:
        </div>
        <br />
        <div class="example-container mat-elevation-z8">
          <table mat-table [dataSource]="reporttimeininventory" class="mat-elevation-z8">
            <!-- SoldDate Column -->
            <ng-container matColumnDef="VehicleType">
              <th mat-header-cell *matHeaderCellDef> Vehicle Type </th>
              <td mat-cell *matCellDef="let element2"> {{element2.VehicleType}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="AverageDaysinInventory">
              <th mat-header-cell *matHeaderCellDef> Average Days in Inventory </th>
              <td mat-cell *matCellDef="let element2"> {{element2.AverageDaysinInventory}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumntimeininventory; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumntimeininventory;let element2"></tr>
          </table>
        </div>
      </div>
    </mat-tab>

    <!-----------------------------------Parts Statistics------------------------------------------->
    <mat-tab label="Parts Statistics">
      <div fxLayout="row" fxLayoutAlign="start center">
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="PartsStats()">Load</button>
        </div>
        <div style="width: 50px; margin: 45px; ">
          <button mat-raised-button color="primary" class="search-button" (click)="PartsStatsReset()">Clear</button>
        </div>
      </div>
      <div *ngIf="partstatstableisShown">
        <div class="title-with-boarder2" style="margin-top:2.5%">
          Results:
        </div>
        <br />
        <div class="example-container mat-elevation-z8">
          <table mat-table [dataSource]="reportpartsStats" class="mat-elevation-z8">
            <!-- SoldDate Column -->
            <ng-container matColumnDef="VendorName">
              <th mat-header-cell *matHeaderCellDef> Vendor Name </th>
              <td mat-cell *matCellDef="let element3"> {{element3.VendorName}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="totalquantity">
              <th mat-header-cell *matHeaderCellDef> Total Number Supplied </th>
              <td mat-cell *matCellDef="let element3"> {{element3.totalquantity}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="totalcost">
              <th mat-header-cell *matHeaderCellDef> Total Cost </th>
              <td mat-cell *matCellDef="let element3"> {{element3.totalcost}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnpartsStats; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnpartsStats;let element"></tr>
          </table>
        </div>
      </div>
    </mat-tab>

    

